{% set statuses = ['valid', 'false positive', 'ignored'] %}
{% set severities = ['critical', 'high', 'medium', 'low', 'info'] %}


<Table-Card-Findings
        @register="register"
        instance_name="table_findings"

        header='Findings'
        :table_attributes="{
            id: 'errors',
            'data-detail-view': 'true',
            'data-detail-view-icon': 'true',
            'data-filter-control': 'true',
            'data-detail-formatter': 'findings_formatter_details',
            'data-page-size': 10
        }"
        container_classes="card-12"
>
    <template #actions="{master}">
        <modal-save-filter
                v-if="master.showModal"
                @save-filter-as="master.saveFilterAs"
                @open-modal="master.openModal"
                @save-new-filter="master.saveNewFilter"
                :loading="master.loadingSaveAs"
        ></modal-save-filter>
        <div class="d-flex justify-content-end pb-4">
            <ul class="custom-tabs nav nav-pills mr-3 align-content-center"
                role="tablist"
            >
                {% for item in ['all', 'valid', 'false positive', 'ignored'] %}
                    <li class="nav-item" role="presentation">
                        <a
                                class="text-uppercase {% if item == 'all' %}active{% endif %}"
                                data-toggle="pill"
                                href="#"
                                role="tab"
                                aria-controls="pills-filter"
                                aria-selected="true"
                                @click="master.handle_status_filter($event.target.innerText)"
                        >
                            {{ item }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
            <choose-filter
                    :filters="master.filters"
                    :loading-filters="master.loadingFilters"
                    :loading-delete="master.loadingDelete"
                    @select-filter="master.selectFilter"
                    @create-filter="master.createFilter"
                    @delete-filter="master.deleteFilter"
            ></choose-filter>


            <div class="dropdown_multilevel mr-2">
                <button class="btn btn-secondary dropdown-toggle font-weight-400" type="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Bulk Actions
                </button>
                <ul class="dropdown-menu">
                    <li class="dropdown-menu_item dropdown-item d-flex align-items-center">
                        <span class="w-100">Severity</span>
                        <i class="fa fa-sort-down" style="transform: rotate(270deg)"></i>
                        <ul class="submenu dropdown-menu">
                            {% for item in severities %}
                                <li class="dropdown-menu_item dropdown-item d-flex align-items-center"
                                    @click="master.bulkModify('severity', '{{ item }}')"
                                >
                                    <span class="w-100">{{ item }}</span>
                                </li>
                            {% endfor %}
                        </ul>
                    </li>
                    <li class="dropdown-menu_item dropdown-item d-flex align-items-center">
                        <span class="w-100">Status</span>
                        <i class="fa fa-sort-down" style="transform: rotate(270deg)"></i>
                        <ul class="submenu dropdown-menu">
                            {% for item in statuses %}
                                <li class="dropdown-menu_item dropdown-item d-flex align-items-center"
                                    @click="master.bulkModify('status', '{{ item }}')"
                                >
                                    <span class="w-100">{{ item }}</span>
                                </li>
                            {% endfor %}
                        </ul>
                    </li>
                </ul>
            </div>

            <button type="button" class="btn btn-32 btn-secondary"
                    @click="master.rerender()"
            ><i class="fas fa-sync"></i></button>
        </div>
    </template>
    <template #table_headers>
        <th data-checkbox="true"></th>
        <th scope="col" data-sortable="true" data-field="tool_name"
            data-width="150" data-width-unit="px"
        >
            Scanner
        </th>
        <th scope="col" data-sortable="true" data-field="description">
            Description
        </th>
        <th scope="col" data-sortable="true" data-field="severity" data-align="center"
            data-width="150" data-width-unit="px"
                            data-formatter='findings_formatter_severity'
                            data-events="findings_eventhandler"
        >
            Severity
        </th>
        <th scope="col" data-sortable="true" data-field="status" data-align="center"
            data-width="150" data-width-unit="px"
                data-formatter='findings_formatter_status'
                data-events="findings_eventhandler"
        >
            Status
        </th>
    </template>
</Table-Card-Findings>


