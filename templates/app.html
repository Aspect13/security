<div class="d-flex">
    <div class="card card-x card-table-sm">

        <div class="card-header">
            <div class="row">
                <div class="col-5">
                    <h3>Application Tests</h3>
                </div>
                <div class="col-7">
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-32 btn-secondary" id="create_test" data-toggle="modal"
                                data-target="#createApplicationTest"><i class="fas fa-plus"></i></button>
                        {#                        <button type="button" class="btn btn-32 btn-secondary" id="filter_test"><i class="fas fa-filter"></i></button>#}
                        <button type="button" class="btn btn-32 btn-secondary" id="delete_test"><i
                                class="fas fa-trash-alt"></i></button>
                    </div>
                </div>
            </div>
        </div>

        <div class="card-body">
            <table class="table table-borderless"
                   id="tests-list"
                   data-unique-id="id"
                   data-toggle="table"
                   data-url="/api/v1/security/{{ config.id }}/dast"
                   data-pagination="true"
                   data-page-size=5
                   data-side-pagination="server"
                   data-pagination-parts='["pageInfoShort", "pageList"]'
                   data-pagination-pre-text="<img src='{{ url_for('design-system.static', filename='assets/ico/arrow_left.svg') }}'>"
                   data-pagination-next-text="<img src='{{ url_for('design-system.static', filename='assets/ico/arrow_right.svg') }}'>"
            >
                <thead class="thead-light">
                <tr>
                    <th scope="col" data-checkbox="true"></th>
                    <th scope="col" data-sortable="true" data-field="name">Name</th>
                    <th scope="col" data-sortable="true" data-field="urls_to_scan">Urls</th>
                    <th scope="col" data-sortable="true" data-field="test_uid" data-visible="false">Uuid</th>
                    <th scope="col" data-sortable="true" data-field="integrations"
                        data-formatter="tableFormatters.tests_tools"
                    >
                        Tools
                    </th>
                    <th scope="col"
                        data-align="right"
                        data-events="tableFormatters.status_events"
                        data-formatter="tableFormatters.tests_actions"
                        data-width="100" data-width-unit="px"
                    >
                        Actions
                    </th>
                </tr>
                </thead>
            </table>
        </div>
    </div>

    <div class="card card-x card-table-sm">

        <div class="card-header">
            <div class="row">
                <div class="col-4">
                    <h3>Thresholds</h3>
                </div>
                <div class="col-8">
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-32 btn-secondary"><i class="fas fa-plus"></i></button>
                        <button type="button" class="btn btn-32 btn-secondary"><i class="fas fa-sync"></i></button>
                        <button type="button" class="btn btn-32 btn-secondary"><i
                                class="fas fa-filter"></i></button>
                        <button type="button" class="btn btn-32 btn-secondary"><i class="fas fa-tag"></i></button>
                        <button type="button" class="btn btn-32 btn-secondary"><i
                                class="fas fa-trash-alt"></i></button>
                    </div>
                </div>
            </div>
        </div>

        <div class="card-body">
            <table class="table table-borderless"
                   id="threshold-list"
                   data-toggle="table"
                   data-side-pagination="server"
                   data-virtual-scroll="true"
                   data-pagination-parts='["pageInfoShort", "pageList"]'
            >
                <thead class="thead-light">
                <tr>
                    <th scope="col" data-checkbox="true"></th>
                    <th data-visible="false" data-field="id">index</th>
                    <th scope="col" data-sortable="true" data-field="name" data-formatter=createLinkToTest>Name</th>
                    <th scope="col" data-sortable="true" data-field="tests_count">Tests Count</th>
                    <th scope="col" data-sortable="true" >Runners</th>
                    <th scope="col" data-field="lg_type" data-formatter="actionFormatter">Actions</th>
                </tr>
                </thead>
            </table>
        </div>
    </div>
</div>

<div class="card card-12 card-table-sm">

    <div class="card-header">
        <div class="row">
            <div class="col-4">
                <h3>Reports</h3>
            </div>
            <div class="col-8">
                <div class="d-flex justify-content-end">
                    <button type="button" class="btn btn-32 btn-secondary"><i class="fas fa-sync"></i></button>
                    <button type="button" class="btn btn-32 btn-secondary"><i class="fas fa-filter"></i></button>
                    <button type="button" class="btn btn-32 btn-secondary"><i class="fas fa-tag"></i></button>
                    <button type="button" class="btn btn-32 btn-secondary"><i class="fas fa-trash-alt"></i></button>
                </div>
            </div>
        </div>
    </div>

    <div class="card-body">
        <table class="table table-borderless"
               id="results-list"
               data-toggle="table"
               data-url="/api/v1/security/{{ config.id }}/dast/results"
               data-virtual-scroll="true"
               data-pagination="true"
               data-page-size=10
               data-side-pagination="server"
               data-pagination-parts='["pageInfoShort", "pageList"]'
        >
            <thead class="thead-light">
            <tr>
                <th scope="col" data-checkbox="true"></th>
                <th data-visible="false" data-field="id">index</th>
                <th scope="col" data-sortable="true" data-field="test_name"
                    data-formatter="tableFormatters.reports_test_name_button">
                    Name
                </th>
                <th scope="col" data-sortable="true" data-field="start_date">Start</th>
                <th scope="col" data-sortable="true" data-field="duration">Duration</th>
                <th scope="col" data-sortable="true" data-field="findings">Findings</th>
                <th scope="col" data-sortable="true" data-field="false_positive">False Positive</th>
                <th scope="col" data-sortable="true" data-field="excluded">Excl</th>
                <th scope="col" data-sortable="true" data-field="info">Info</th>
                <th scope="col" data-sortable="true" data-field="tags" data-formatter="reportsTagFormatter">
                    Tag
                </th>
                <th scope="col" data-field="test_status.status"
                    data-formatter="tableFormatters.reports_status_formatter">
                    Status
                </th>
            </tr>
            </thead>
        </table>
    </div>
</div>

<div class="modal modal-base fixed-left fade shadow-sm" tabindex="-1" role="dialog" id="createApplicationTest">
    <div class="modal-dialog modal-dialog-aside" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row w-100">
                    <div class="col">
                        <h2 id="modal_title">Add Application Test</h2>
                    </div>
                    <div class="col-xs">
                        <button type="button" class="btn btn-sm btn-projects" data-dismiss="modal"><i
                                class="fas fa-file-alt"></i> Use template
                        </button>
                        <button type="button" class="btn btn-sm btn-projects" data-dismiss="modal"><i
                                class="fas fa-file"></i> Save as template
                        </button>
                        <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal" aria-label="Close">
                            Cancel
                        </button>
                        <button type="button" id="security_test_save" class="btn btn-sm btn-secondary">
                            Save
                        </button>
                        <button type="button" id="security_test_save_and_run" class="btn btn-sm btn-basic">
                            Save and start
                        </button>
                    </div>
                </div>
            </div>
            {{ template_slot("alert_bar", payload={
                "alert_container_id": "alertCreateTest",
                "max_alerts": 2,
                "overlay_max_width": "1010px"
            }) | safe }}


            <div class="modal-body">

                <div class="row">
                    <div class="form-group col-6">
                        <h9>Test Name</h9>
                        <p>
                            <h13>Enter a name that describes the purpose of your test</h13>
                        </p>
                        <input type="text" id="test_name" class="form-control form-control-alternative"
                               placeholder="Test Name">
                        <div class="invalid-feedback"></div>
                    </div>
                    <div class="form-group col-6">
                        <h9>Test context/scope</h9>
                        <p>
                            <h13>Description</h13>
                        </p>
                        <input type="text" id="test_description" class="form-control form-control-alternative"
                               placeholder="Some data">
                    </div>
                </div>

                {{ template_slot("params_table", payload={
                    "caption": "Test Parameters",
                    "default_params": [
                        {"name": "URL to scan", "default": "", "type": "URLs", "description": "Data"},
                        {"name": "Exclusions", "default": "", "type": "List", "description": "Data"},
                        {"name": "Scan location", "default": "Carrier default config", "type": "Item", "description": "Data"},
                    ],
                    "disabled_names": ("URL to scan", "Exclusions", "Scan location"),
                    "modal_id": "security",
                    "hidden_columns": []
                }) | safe }}

                {{ template_slot("integrations_security_create", payload=config) | safe }}

                {{ template_slot("security_scheduling_test_create", payload=config) | safe }}

            </div>
        </div>
    </div>
</div>

</div>

<script src="{{ url_for('theme.static', filename='js/components/tags.js') }}"></script>
<script src="{{ url_for('security.static', filename='js/security.js') }}"></script>